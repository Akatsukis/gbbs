<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.72">
<link rel="alternate" type="application/rss+xml" href="/gbbs/blog/rss.xml" title="GBBS Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/gbbs/blog/atom.xml" title="GBBS Blog Atom Feed">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"><title data-react-helmet="true">BFS | GBBS</title><meta data-react-helmet="true" property="og:url" content="https://paralg.github.io/gbbs/docs/tutorial/bfs_tutorial"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="BFS | GBBS"><meta data-react-helmet="true" name="description" content="In this tutorial we&#x27;ll implement a parallel version of Breadth-First Search in"><meta data-react-helmet="true" property="og:description" content="In this tutorial we&#x27;ll implement a parallel version of Breadth-First Search in"><link data-react-helmet="true" rel="shortcut icon" href="/gbbs/img/graph.svg"><link data-react-helmet="true" rel="canonical" href="https://paralg.github.io/gbbs/docs/tutorial/bfs_tutorial"><link data-react-helmet="true" rel="alternate" href="https://paralg.github.io/gbbs/docs/tutorial/bfs_tutorial" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://paralg.github.io/gbbs/docs/tutorial/bfs_tutorial" hreflang="x-default"><link rel="stylesheet" href="/gbbs/assets/css/styles.fededd78.css">
<link rel="preload" href="/gbbs/assets/js/styles.dc38d310.js" as="script">
<link rel="preload" href="/gbbs/assets/js/runtime~main.cf4dd21d.js" as="script">
<link rel="preload" href="/gbbs/assets/js/main.39bf247a.js" as="script">
<link rel="preload" href="/gbbs/assets/js/1.a1ea751b.js" as="script">
<link rel="preload" href="/gbbs/assets/js/2.a380b37c.js" as="script">
<link rel="preload" href="/gbbs/assets/js/49.3701e664.js" as="script">
<link rel="preload" href="/gbbs/assets/js/50.069fe288.js" as="script">
<link rel="preload" href="/gbbs/assets/js/935f2afb.87b18d3b.js" as="script">
<link rel="preload" href="/gbbs/assets/js/17896441.821a1ac2.js" as="script">
<link rel="preload" href="/gbbs/assets/js/1a0201f8.c11938dc.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/gbbs/"><img src="/gbbs/img/graph.svg" alt="GBBS Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/gbbs/img/graph.svg" alt="GBBS Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">GBBS</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/gbbs/docs/introduction">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/gbbs/docs/library/overview">Library</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/gbbs/docs/research">Publications and Resources</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/gbbs/docs/benchmarks/overview">Benchmark Implementations</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/ParAlg/gbbs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/gbbs/"><img src="/gbbs/img/graph.svg" alt="GBBS Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/gbbs/img/graph.svg" alt="GBBS Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">GBBS</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/gbbs/docs/introduction">Docs</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/gbbs/docs/library/overview">Library</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/gbbs/docs/research">Publications and Resources</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/gbbs/docs/benchmarks/overview">Benchmark Implementations</a></li><li class="menu__list-item"><a href="https://github.com/ParAlg/gbbs" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper main-docs-wrapper"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/install">Install</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/compile">Compile</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/run">Running Benchmarks</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/formats">Graph Formats</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/python_bindings">Python Bindings</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Tutorial</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/gbbs/docs/tutorial/bfs_tutorial">BFS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/gbbs/docs/tutorial/kcore_tutorial">KCore</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Research</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/research">Publications and Resources</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/contributors">Contributors</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Library</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/library/overview">Overview</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Benchmark Implementations</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/benchmarks/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/benchmarks/definitions">Definitions</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Shortest Path Problems</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/benchmarks/sssp/breadth_first_search">BFS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/benchmarks/sssp/integral_weight_sssp">Integral-Weight SSSP (weighted BFS)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/benchmarks/sssp/positive_weight_sssp">Positive-Weight SSSP (Delta Stepping)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/benchmarks/sssp/general_weight_sssp">General-Weight SSSP (Bellman-Ford)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/benchmarks/sssp/ss_widest_path">Single-Source Widest Path</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/benchmarks/sssp/ss_betweenness_centrality">Single-Source Betweenness Centrality</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/benchmarks/sssp/spanner">Graph Spanner</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Connectivity Problems</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/benchmarks/connectivity/biconnectivity">Biconnectivity</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/benchmarks/connectivity/connectivity">Connectivity</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/benchmarks/connectivity/low_diameter_decomposition">Low Diameter Decomposition</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/benchmarks/connectivity/minimum_spanning_forest">Minimum Spanning Forest</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/benchmarks/connectivity/spanning_forest">Spanning Forest</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/benchmarks/connectivity/strongly_connected_components">Strongly Connected Components</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Covering Problems</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/benchmarks/covering/maximal_independent_set">Maximal Independent Set</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/benchmarks/covering/maximal_matching">Maximal Matching</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/benchmarks/covering/graph_coloring">Graph Coloring</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/benchmarks/covering/apx_set_cover">Approximate Set Cover</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Substructure Problems</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/benchmarks/substructure/triangle_counting">Triangle Counting</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/benchmarks/substructure/k_clique_counting">k-Clique Counting</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/benchmarks/substructure/k_core">k-Core (Coreness)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/benchmarks/substructure/k_truss">k-Truss (Trussness)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/benchmarks/substructure/apx_densest_subgraph">Approximate Densest Subgraph</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/benchmarks/substructure/low_outdegree_orientation">Low-Outdegree Orientation</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Eigenvector Problems</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/benchmarks/eigenvector/pagerank">PageRank</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/gbbs/docs/benchmarks/eigenvector/cosimrank">CoSimRank</a></li></ul></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">BFS</h1></header><div class="markdown"><p>In this tutorial we&#x27;ll implement a parallel version of Breadth-First Search in
GBBS. Given a graph, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>=</mo><mo stretchy="false">(</mo><mi>V</mi><mo separator="true">,</mo><mi>E</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">G = (V,E)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord mathdefault">G</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.22222em">V</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathdefault" style="margin-right:0.05764em">E</span><span class="mclose">)</span></span></span></span></span>, and a source node <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em"></span><span class="mord mathdefault">s</span></span></span></span></span>, a Breadth-First Search
processes the graph level by level, starting from <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em"></span><span class="mord mathdefault">s</span></span></span></span></span>. The output of the
algorithm is an array <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord mathdefault">A</span></span></span></span></span> s.t. <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∀</mi><mi>v</mi><mo>∈</mo><mi>V</mi><mo separator="true">,</mo><mi>A</mi><mo stretchy="false">[</mo><mi>v</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\forall v \in V, A[v]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em"></span><span class="mord">∀</span><span class="mord mathdefault" style="margin-right:0.03588em">v</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathdefault" style="margin-right:0.22222em">V</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord mathdefault">A</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03588em">v</span><span class="mclose">]</span></span></span></span></span> holds the parent of <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em"></span><span class="mord mathdefault" style="margin-right:0.03588em">v</span></span></span></span></span> in
the <em>breadth-first tree</em> rooted at <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em"></span><span class="mord mathdefault">s</span></span></span></span></span>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="getting-started"></a>Getting Started<a class="hash-link" href="#getting-started" title="Direct link to heading">#</a></h3><p>In what follows we will reimplement the BFS algorithm shown in the
file above and go through all of the steps to create a new benchmark
in GBBS.</p><p>To get started, cd into the <code>benchmarks/BFS</code> directory and create a
new directory <code>BFS_tutorial</code>. Create two new files in this directory,
<code>BFS.cc</code> and <code>BFS.h</code>.
We will start with the interesting algorithmic code in <code>BFS.h</code>.</p><p>Let&#x27;s start by creating a stub for the BFS function:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cpp"><div tabindex="0" class="prism-code language-cpp codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword" style="color:#e3116c">template</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;</span><span class="token keyword" style="color:#e3116c">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(227, 98, 9)">Graph</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">inline</span><span class="token plain"> sequence</span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;</span><span class="token plain">uintE</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">BFS</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">Graph</span><span class="token operator" style="color:rgb(0, 92, 197)">&amp;</span><span class="token plain"> G</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> uintE source</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>One of the goals of GBBS is to abstract away implementation specific
details about how the graph is represented. Towards this goal, the
algorithm implementations in GBBS typically take the graph type as a
template argument, as shown above. This approach lets us run the same
code on the graph whether it is compressed or uncompressed, and
directed or undirected.</p><p>The <code>uintE</code> type name is an integer type used to represent vertex-ids
in GBBS (the analogous type for edge-ids is <code>uintT</code> although we won&#x27;t
use it in this implementation).</p><p>The BFS function&#x27;s signature indicates that it takes as input a graph,
and a source vertex-id and returns a sequence of integers representing
the parent of each vertex in the BFS tree.</p><p>Next, modify the BFS implementation to the following:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cpp"><div tabindex="0" class="prism-code language-cpp codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword" style="color:#e3116c">template</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;</span><span class="token keyword" style="color:#e3116c">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(227, 98, 9)">Graph</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">inline</span><span class="token plain"> sequence</span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;</span><span class="token plain">uintE</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">BFS</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">Graph</span><span class="token operator" style="color:rgb(0, 92, 197)">&amp;</span><span class="token plain"> G</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> uintE source</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">using</span><span class="token plain"> W </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">typename</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(227, 98, 9)">Graph</span><span class="token operator" style="color:rgb(0, 92, 197)">::</span><span class="token plain">weight_type</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  uintE n </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> G</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// Creates Parents array, initialized to all -1, except for source.</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">auto</span><span class="token plain"> Parents </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> sequence</span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;</span><span class="token plain">uintE</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token operator" style="color:rgb(0, 92, 197)">&amp;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">size_t i</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">return</span><span class="token plain"> UINT_E_MAX</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  Parents</span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token plain">source</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> source</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Here, we set <code>W</code> to the weight-type in the provided graph. For
unweighted graphs, this is the type of an empty struct (with no data),
and otherwise it is the graph&#x27;s weight type, e.g., <code>int32</code> or <code>float</code>.</p><p>Next, we set the <code>Parents</code> array to a sequence containing <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em"></span><span class="mord mathdefault">n</span></span></span></span></span> (<code>G.n</code>)
elements where the i&#x27;th element is some suitable null value, in this
case the maximum unsigned <code>uintE</code>, <code>UINT_E_MAX</code>. Note that the
initialization of this sequence will happen in parallel when we use a
parallel runtime.
We also set the parent of the source vertex to itself.</p><p>So far, we have set up the variables and data necessary for the
algorithm, and we&#x27;re ready to start the interesting parts of the BFS.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="representing-a-frontier"></a>Representing a Frontier<a class="hash-link" href="#representing-a-frontier" title="Direct link to heading">#</a></h3><p>We can express a frontier generated by the BFS with the <strong><code>vertexSubset</code></strong>
datatype (from the Ligra interface), which lets us represent a subset
of the vertices. Each level of the  traversal will be represented by a
<code>vertexSubset</code>. The initial <code>vertexSubset</code>, is just a set containing
our source node can be constructed the following constructor</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cpp"><div tabindex="0" class="prism-code language-cpp codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword" style="color:#e3116c">template</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;</span><span class="token keyword" style="color:#e3116c">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(227, 98, 9)">W</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">struct</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(227, 98, 9)">BFS_F</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  uintE</span><span class="token operator" style="color:rgb(0, 92, 197)">*</span><span class="token plain"> Parents</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token function" style="color:rgb(111, 66, 193)">BFS_F</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">uintE</span><span class="token operator" style="color:rgb(0, 92, 197)">*</span><span class="token plain"> _Parents</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">Parents</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">_Parents</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">inline</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">bool</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">updateAtomic</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">uintE s</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> uintE d</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> W w</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// Atomically update.</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">return</span><span class="token plain"> pbbslib</span><span class="token operator" style="color:rgb(0, 92, 197)">::</span><span class="token function" style="color:rgb(111, 66, 193)">atomic_compare_and_swap</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token operator" style="color:rgb(0, 92, 197)">&amp;</span><span class="token plain">Parents</span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token plain">d</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> UINT_E_MAX</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">inline</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">bool</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">update</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">uintE s</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> uintE d</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> W w</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// Defer to updateAtomic for now.</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">updateAtomic</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> d</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> w</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// Cond function checks if vertex has been visited yet.</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">inline</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">bool</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">cond</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">uintE d</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">Parents</span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token plain">d</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">==</span><span class="token plain"> UINT_E_MAX</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">vertexSubset </span><span class="token function" style="color:rgb(111, 66, 193)">Frontier</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> source</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// creates initial frontier</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="traversing-a-frontier"></a>Traversing a Frontier<a class="hash-link" href="#traversing-a-frontier" title="Direct link to heading">#</a></h3><p>Now, we need to describe the logic to produce the next frontier given the current
frontier. Enter <strong><code>edgeMap</code></strong>. <code>edgeMap</code> (from the Ligra interface)
allows us to process the out edges of a <code>vertexSubset</code>, and produce a
new <code>vertexSubset</code>.</p><p>The behavior of <code>edgeMap</code> is intended to be customized by providing a
user-defined structure. <code>edgeMap</code> expects a parameter of some template
class <code>F</code> that has the following fields:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cpp"><div tabindex="0" class="prism-code language-cpp codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword" style="color:#e3116c">template</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;</span><span class="token keyword" style="color:#e3116c">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(227, 98, 9)">W</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">struct</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(227, 98, 9)">F</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token function" style="color:rgb(111, 66, 193)">F</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">inline</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">bool</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">update</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">uintE u</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> uintE v</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> W wgh</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// logic for how to process the edge (s,d)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">inline</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">bool</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">updateAtomic</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">uintE u</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> uintE v</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> W wgh</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// logic for how to process the edge (s,d)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">inline</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">bool</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">cond</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">uintE d</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// return 1 if update should be applied on and edge (s,d)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">// return 0 otherwise</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>There is an important distinction between <code>update</code> and <code>updateAtomic</code>
that we will discuss later. For now, we will make sure that all
<code>update</code> logic is atomic.  Atomicity is important because if the
vertex has more than one in-edge from the current frontier, then
multiple calls to <code>update</code> can happen in parallel which may result in
an incorrect result.</p><p>For our BFS, let&#x27;s implement a struct <code>BFS_F</code> where</p><ul><li><p><code>updateAtomic</code>: atomically update <code>Parents</code> array. We can implement this using a
compare and swap operation, which is provided in the <code>pbbslib</code>
library as <code>pbbslib::atomic_compare_and_swap</code>.</p></li><li><p><code>cond</code>: avoid revisiting previously visited vertices by checking if
<code>Parents[v] == UINT_E_MAX</code>.</p></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cpp"><div tabindex="0" class="prism-code language-cpp codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword" style="color:#e3116c">template</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;</span><span class="token keyword" style="color:#e3116c">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(227, 98, 9)">W</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">struct</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(227, 98, 9)">BFS_F</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  uintE</span><span class="token operator" style="color:rgb(0, 92, 197)">*</span><span class="token plain"> Parents</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token function" style="color:rgb(111, 66, 193)">BFS_F</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">uintE</span><span class="token operator" style="color:rgb(0, 92, 197)">*</span><span class="token plain"> _Parents</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">Parents</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">_Parents</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">inline</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">bool</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">updateAtomic</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">uintE s</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> uintE d</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> W w</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// Atomically update.</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">return</span><span class="token plain"> pbbslib</span><span class="token operator" style="color:rgb(0, 92, 197)">::</span><span class="token function" style="color:rgb(111, 66, 193)">atomic_compare_and_swap</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token operator" style="color:rgb(0, 92, 197)">&amp;</span><span class="token plain">Parents</span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token plain">d</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> UINT_E_MAX</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">inline</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">bool</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">update</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">uintE s</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> uintE d</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> W w</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// Defer to updateAtomic for now.</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">updateAtomic</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> d</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> w</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// Cond function checks if vertex has been visited yet.</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">inline</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">bool</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">cond</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">uintE d</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">Parents</span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token plain">d</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">==</span><span class="token plain"> UINT_E_MAX</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Add this code before the definition of <code>BFS</code>.</p><p>Notice that while <code>BFS_F</code> will correctly produce the next frontier, the
tree computed by the BFS is still non-deterministic! We will discuss how to
fix this in a later section.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="implementing-traversal-logic"></a>Implementing Traversal Logic<a class="hash-link" href="#implementing-traversal-logic" title="Direct link to heading">#</a></h3><p>All we need to do to finish up the BFS is to actually call <code>edgeMap</code>, and
add a termination condition that signifies when the traversal is finished.
Given a current frontier, our condition should just apply the edgeMap while
the current frontier is non-empty. In code:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cpp"><div tabindex="0" class="prism-code language-cpp codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token keyword" style="color:#e3116c">while</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token operator" style="color:rgb(0, 92, 197)">!</span><span class="token plain">Frontier</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token function" style="color:rgb(111, 66, 193)">isEmpty</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// Loop until frontier is empty.</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  Frontier </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">edgeMap</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">GA</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> Frontier</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">BFS_F</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">Parents</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token function" style="color:rgb(111, 66, 193)">begin</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="the-final-algorithm"></a>The Final Algorithm<a class="hash-link" href="#the-final-algorithm" title="Direct link to heading">#</a></h3><p>The last step is to just free any memory allocated in the body of the BFS.
Our finished BFS algorithm should look as follows:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cpp"><div tabindex="0" class="prism-code language-cpp codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:#e3116c">pragma</span><span class="token macro property"> </span><span class="token macro property expression">once</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:#e3116c">include</span><span class="token macro property"> </span><span class="token macro property string">&quot;gbbs/gbbs.h&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">namespace</span><span class="token plain"> gbbs </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">template</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;</span><span class="token keyword" style="color:#e3116c">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(227, 98, 9)">W</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">struct</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(227, 98, 9)">BFS_F</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  uintE</span><span class="token operator" style="color:rgb(0, 92, 197)">*</span><span class="token plain"> Parents</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token function" style="color:rgb(111, 66, 193)">BFS_F</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">uintE</span><span class="token operator" style="color:rgb(0, 92, 197)">*</span><span class="token plain"> _Parents</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">Parents</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">_Parents</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">inline</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">bool</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">updateAtomic</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">uintE s</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> uintE d</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> W w</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// Atomically update.</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">return</span><span class="token plain"> pbbslib</span><span class="token operator" style="color:rgb(0, 92, 197)">::</span><span class="token function" style="color:rgb(111, 66, 193)">atomic_compare_and_swap</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token operator" style="color:rgb(0, 92, 197)">&amp;</span><span class="token plain">Parents</span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token plain">d</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> UINT_E_MAX</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">inline</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">bool</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">update</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">uintE s</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> uintE d</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> W w</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// Defer to updateAtomic for now.</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token keyword" style="color:#e3116c">return</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">updateAtomic</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> d</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> w</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// Cond function checks if vertex has been visited yet.</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">inline</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">bool</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">cond</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">uintE d</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">Parents</span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token plain">d</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">==</span><span class="token plain"> UINT_E_MAX</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">template</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;</span><span class="token keyword" style="color:#e3116c">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(227, 98, 9)">Graph</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">inline</span><span class="token plain"> sequence</span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;</span><span class="token plain">uintE</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">BFS</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">Graph</span><span class="token operator" style="color:rgb(0, 92, 197)">&amp;</span><span class="token plain"> G</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> uintE source</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">using</span><span class="token plain"> W </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">typename</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(227, 98, 9)">Graph</span><span class="token operator" style="color:rgb(0, 92, 197)">::</span><span class="token plain">weight_type</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  uintE n </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> G</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// Creates Parents array, initialized to all -1, except for source.</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">auto</span><span class="token plain"> Parents </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> sequence</span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;</span><span class="token plain">uintE</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token operator" style="color:rgb(0, 92, 197)">&amp;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">size_t i</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">return</span><span class="token plain"> UINT_E_MAX</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  Parents</span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token plain">source</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> source</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  vertexSubset </span><span class="token function" style="color:rgb(111, 66, 193)">Frontier</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">n</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> source</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  size_t reachable </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">while</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token operator" style="color:rgb(0, 92, 197)">!</span><span class="token plain">Frontier</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token function" style="color:rgb(111, 66, 193)">isEmpty</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    std</span><span class="token operator" style="color:rgb(0, 92, 197)">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;&lt;</span><span class="token plain"> Frontier</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token function" style="color:rgb(111, 66, 193)">size</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;&lt;</span><span class="token plain"> std</span><span class="token operator" style="color:rgb(0, 92, 197)">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    reachable </span><span class="token operator" style="color:rgb(0, 92, 197)">+=</span><span class="token plain"> Frontier</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token function" style="color:rgb(111, 66, 193)">size</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    Frontier </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">edgeMap</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">G</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> Frontier</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> BFS_F</span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;</span><span class="token plain">W</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">Parents</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token function" style="color:rgb(111, 66, 193)">begin</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  Frontier</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token function" style="color:rgb(111, 66, 193)">del</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  std</span><span class="token operator" style="color:rgb(0, 92, 197)">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;&lt;</span><span class="token plain"> </span><span class="token string">&quot;Reachable: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;&lt;</span><span class="token plain"> reachable </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;&lt;</span><span class="token plain"> std</span><span class="token operator" style="color:rgb(0, 92, 197)">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">return</span><span class="token plain"> Parents</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// namespace gbbs</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>At this point we have created a BFS implementation</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="wrapping-up-bfscc-and-build-files"></a>Wrapping up: BFS.cc and Build-files.<a class="hash-link" href="#wrapping-up-bfscc-and-build-files" title="Direct link to heading">#</a></h3><p>Lastly, let&#x27;s see what code we need to add in order to create a binary to
run BFS on graph inputs. Place the following code in <code>BFS.cc</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cpp"><div tabindex="0" class="prism-code language-cpp codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:#e3116c">include</span><span class="token macro property"> </span><span class="token macro property string">&quot;BFS.h&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">namespace</span><span class="token plain"> gbbs </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">template</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;</span><span class="token keyword" style="color:#e3116c">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(227, 98, 9)">Graph</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token keyword" style="color:#e3116c">double</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">BFS_runner</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">Graph</span><span class="token operator" style="color:rgb(0, 92, 197)">&amp;</span><span class="token plain"> G</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> commandLine P</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  uintE src </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token keyword" style="color:#e3116c">static_cast</span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;</span><span class="token plain">uintE</span><span class="token operator" style="color:rgb(0, 92, 197)">&gt;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">P</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token function" style="color:rgb(111, 66, 193)">getOptionLongValue</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token string">&quot;-src&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  std</span><span class="token operator" style="color:rgb(0, 92, 197)">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;&lt;</span><span class="token plain"> </span><span class="token string">&quot;### Application: BFS&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;&lt;</span><span class="token plain"> std</span><span class="token operator" style="color:rgb(0, 92, 197)">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  std</span><span class="token operator" style="color:rgb(0, 92, 197)">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;&lt;</span><span class="token plain"> </span><span class="token string">&quot;### Graph: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;&lt;</span><span class="token plain"> P</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token function" style="color:rgb(111, 66, 193)">getArgument</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;&lt;</span><span class="token plain"> std</span><span class="token operator" style="color:rgb(0, 92, 197)">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  std</span><span class="token operator" style="color:rgb(0, 92, 197)">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;&lt;</span><span class="token plain"> </span><span class="token string">&quot;### Threads: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;&lt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">num_workers</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;&lt;</span><span class="token plain"> std</span><span class="token operator" style="color:rgb(0, 92, 197)">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  std</span><span class="token operator" style="color:rgb(0, 92, 197)">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;&lt;</span><span class="token plain"> </span><span class="token string">&quot;### n: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;&lt;</span><span class="token plain"> G</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token plain">n </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;&lt;</span><span class="token plain"> std</span><span class="token operator" style="color:rgb(0, 92, 197)">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  std</span><span class="token operator" style="color:rgb(0, 92, 197)">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;&lt;</span><span class="token plain"> </span><span class="token string">&quot;### m: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;&lt;</span><span class="token plain"> G</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token plain">m </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;&lt;</span><span class="token plain"> std</span><span class="token operator" style="color:rgb(0, 92, 197)">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  std</span><span class="token operator" style="color:rgb(0, 92, 197)">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;&lt;</span><span class="token plain"> </span><span class="token string">&quot;### Params: -src = &quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;&lt;</span><span class="token plain"> src </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;&lt;</span><span class="token plain"> std</span><span class="token operator" style="color:rgb(0, 92, 197)">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  std</span><span class="token operator" style="color:rgb(0, 92, 197)">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;&lt;</span><span class="token plain"> </span><span class="token string">&quot;### ------------------------------------&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;&lt;</span><span class="token plain"> std</span><span class="token operator" style="color:rgb(0, 92, 197)">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  std</span><span class="token operator" style="color:rgb(0, 92, 197)">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;&lt;</span><span class="token plain"> </span><span class="token string">&quot;### ------------------------------------&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;&lt;</span><span class="token plain"> std</span><span class="token operator" style="color:rgb(0, 92, 197)">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  timer t</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"> t</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token function" style="color:rgb(111, 66, 193)">start</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">auto</span><span class="token plain"> parents </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(111, 66, 193)">BFS</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">G</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> src</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">double</span><span class="token plain"> tt </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> t</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token function" style="color:rgb(111, 66, 193)">stop</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  std</span><span class="token operator" style="color:rgb(0, 92, 197)">::</span><span class="token plain">cout </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;&lt;</span><span class="token plain"> </span><span class="token string">&quot;### Running Time: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;&lt;</span><span class="token plain"> tt </span><span class="token operator" style="color:rgb(0, 92, 197)">&lt;&lt;</span><span class="token plain"> std</span><span class="token operator" style="color:rgb(0, 92, 197)">::</span><span class="token plain">endl</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token keyword" style="color:#e3116c">return</span><span class="token plain"> tt</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain">  </span><span class="token comment" style="color:rgb(106, 153, 85)">// namespace gbbs</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token function" style="color:rgb(111, 66, 193)">generate_main</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">gbbs</span><span class="token operator" style="color:rgb(0, 92, 197)">::</span><span class="token plain">BFS_runner</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(0, 92, 197)">false</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>The main points of interest in this code are the <code>generate_main</code> function,
which is a macro defined by GBBS (see <code>gbbs/benchmark.h</code>) that first loads
the graph supplied as input by the user, and calls <code>gbbs::BFS_runner</code>. The
<code>false</code> flag passed to this macro indicates that this application does not
modify the input graph. The macro expects a runner function that takes as
input a graph and a <code>commandLine</code> object which supplies the command-line
arguments provided by the user.</p><p>Lastly, if you are using Bazel add a file called <code>BUILD</code> with the following
contents to this directory:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cpp"><div tabindex="0" class="prism-code language-cpp codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token function" style="color:rgb(111, 66, 193)">cc_library</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  name </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token string">&quot;BFS&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  hdrs </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token string">&quot;BFS.h&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  deps </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token string">&quot;//gbbs:gbbs&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token function" style="color:rgb(111, 66, 193)">cc_binary</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  name </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token string">&quot;BFS_main&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  srcs </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token string">&quot;BFS.cc&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  deps </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token string">&quot;:BFS&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token function" style="color:rgb(111, 66, 193)">package</span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  default_visibility </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token string">&quot;//visibility:public&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This BUILD file contains two build rules, which tells Bazel how to build
the desired outputs, such as executable binaries (<code>cc_binary</code>) and
libraries (<code>cc_library</code>). Build rules are also called targets, and point to
a specific set of source files and dependencies. A target can also point to
other targets, as seen in the dependencies for <code>cc_binary</code>.</p><p>You can read more about Bazel
<a href="https://docs.bazel.build/versions/master/tutorial/cpp.html" target="_blank" rel="noopener noreferrer">here</a>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="compilation"></a>Compilation<a class="hash-link" href="#compilation" title="Direct link to heading">#</a></h3><p>Using Bazel you can compile the application the BFS application as follows:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">$ bazel build //benchmarks/BFS/BFS_tutorial/...</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>To use <code>make</code> you can copy the makefile from
<code>benchmarks/BFS/NondeterministicBFS/makefile</code>, and run <code>make</code>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="testing"></a>Testing<a class="hash-link" href="#testing" title="Direct link to heading">#</a></h3><p>Let&#x27;s try running our program on one of the test-inputs provided by Ligra in the <code>inputs/</code>
directory.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">$ numactl -i all ./bazel-bin/benchmarks/BFS/NonDeterministicBFS/BFS_main \</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    -s -rounds 4 -src 0 inputs/rMatGraph_J_5_100</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"># list_alloc init_blocks: 1000</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"># after init:</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"># Used: 0, allocated: 79872, node size: 16392, bytes: 1309261824</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">### Application: BFS</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">### Graph: inputs/rMatGraph_J_5_100</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">### Threads: 144</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">### n: 128</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">### m: 708</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">### Params: -src = 0</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">### ------------------------------------</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">### ------------------------------------</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">1</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">8</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">20</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">50</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">41</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">5</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">Reachable: 125</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">### Running Time: 0.000113964</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">...</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>The flags above indicate the following:</p><ul><li>The <code>-s</code> flag indicates that the graph is symmetric.</li><li>The <code>-rounds</code> flag indicates the number of times to run the benchmark.</li><li>The <code>-src</code> flag indicates the source vertex.</li></ul><p>Great! We&#x27;ve successfully implemented a shared memory breadth-first
search in GBBS. You should now have all of the pieces needed to
implement new benchmarks in GBBS.</p></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/gbbs/docs/python_bindings"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Python Bindings</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/gbbs/docs/tutorial/kcore_tutorial"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">KCore »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#getting-started" class="table-of-contents__link">Getting Started</a></li><li><a href="#representing-a-frontier" class="table-of-contents__link">Representing a Frontier</a></li><li><a href="#traversing-a-frontier" class="table-of-contents__link">Traversing a Frontier</a></li><li><a href="#implementing-traversal-logic" class="table-of-contents__link">Implementing Traversal Logic</a></li><li><a href="#the-final-algorithm" class="table-of-contents__link">The Final Algorithm</a></li><li><a href="#wrapping-up-bfscc-and-build-files" class="table-of-contents__link">Wrapping up: BFS.cc and Build-files.</a></li><li><a href="#compilation" class="table-of-contents__link">Compilation</a></li><li><a href="#testing" class="table-of-contents__link">Testing</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/gbbs/docs/tutorial/bfs_tutorial">Tutorial</a></li><li class="footer__item"><a class="footer__link-item" href="/gbbs/docs/introduction">Documentation</a></li><li class="footer__item"><a class="footer__link-item" href="/gbbs/docs/library/overview">Library</a></li><li class="footer__item"><a class="footer__link-item" href="/gbbs/docs/benchmarks/overview">Benchmark Specifications</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/gbbs/docs/contributors">Contributors</a></li><li class="footer__item"><a class="footer__link-item" href="/gbbs/docs/research">Publications and Resources</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Links</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/ParAlg/gbbs" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2021 GBBS Authors.</div></div></div></footer></div>
<script src="/gbbs/assets/js/styles.dc38d310.js"></script>
<script src="/gbbs/assets/js/runtime~main.cf4dd21d.js"></script>
<script src="/gbbs/assets/js/main.39bf247a.js"></script>
<script src="/gbbs/assets/js/1.a1ea751b.js"></script>
<script src="/gbbs/assets/js/2.a380b37c.js"></script>
<script src="/gbbs/assets/js/49.3701e664.js"></script>
<script src="/gbbs/assets/js/50.069fe288.js"></script>
<script src="/gbbs/assets/js/935f2afb.87b18d3b.js"></script>
<script src="/gbbs/assets/js/17896441.821a1ac2.js"></script>
<script src="/gbbs/assets/js/1a0201f8.c11938dc.js"></script>
</body>
</html>